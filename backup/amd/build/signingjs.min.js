function getPosition(a,b){var c=b.getBoundingClientRect();return{X:a.clientX-c.left,Y:a.clientY-c.top}}function initialize(){function a(a){var c={x:a.targetTouches[0].pageX,y:a.targetTouches[0].pageY},d=b;if(d.offsetParent)do c.x-=d.offsetLeft,c.y-=d.offsetTop;while(null!=(d=d.offsetParent));f[a.type](c)}var b=document.getElementById("canvas"),c=b.getContext("2d");c.strokeStyle="#f8920f",c.lineJoin="round",c.lineWidth=10;var d=new Image;d.src="https://3.bp.blogspot.com/_jFM-Fd8NDFE/TLhmRK1h8AI/AAAAAAAAKcU/NKNPe051PbA/s1600/OldCanvas-5.jpg",d.onload=function(){c.drawImage(d,0,0)};var e="ontouchstart"in document.documentElement;if(e){var f={isDrawing:!1,touchstart:function(a){c.beginPath(),c.moveTo(a.x,a.y),this.isDrawing=!0},touchmove:function(a){this.isDrawing&&(c.lineTo(a.x,a.y),c.stroke())},touchend:function(a){this.isDrawing&&(this.touchmove(a),this.isDrawing=!1)}};b.addEventListener("touchstart",a,!1),b.addEventListener("touchmove",a,!1),b.addEventListener("touchend",a,!1),b.addEventListener("touchmove",function(a){a.preventDefault()},!1)}else $("#canvas").mousedown(function(a){var d=getPosition(a,b);c.moveTo(d.X,d.Y),c.beginPath(),$(this).mousemove(function(a){drawLine(a,b,c)}).mouseup(function(a){finishDrawing(a,b,c)}).mouseout(function(a){finishDrawing(a,b,c)})})}function drawLine(a,b,c){var d=getPosition(a,b);c.lineTo(d.X,d.Y),c.stroke()}function finishDrawing(a,b,c){drawLine(a,b,c),c.closePath(),$(b).unbind("mousemove").unbind("mouseup").unbind("mouseout")}function clearCanvas(a,b){b.clearRect(0,0,a.width,a.height)}define(["jquery"],function(a){return{init:function(){initialize()}}});