function initialize(){function a(a,b){var c=a.getBoundingClientRect();return{x:(j?b.touches[0].clientX:b.clientX)-c.left,y:(j?b.touches[0].clientY:b.clientY)-c.top}}function b(){g&&(e.moveTo(i.x,i.y),e.lineTo(h.x,h.y),e.stroke(),i=h)}function c(a,b){b.clearRect(0,0,a.width,a.height),a.width=a.width}var d=document.getElementById("canvas"),e=d.getContext("2d"),f=d.getBoundingClientRect();d.width=f.width,d.height=f.height,e.strokeStyle="#000",e.lineWidth=1;var g=!1,h={x:0,y:0},i=h,j="ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch;$("#clearCanvas").bind("click",function(){c(d,e)}),$("#id_submitbutton").click(function(){var a=$("#canvas")[0].toDataURL();$('[name="signing"]').val(a)}),d.addEventListener(j?"touchstart":"mousedown",function(b){b.preventDefault(),b.stopPropagation(),g=!0,i=a(d,b),h=i}),d.addEventListener(j?"touchmove":"mousemove",function(b){b.preventDefault(),b.stopPropagation(),h=a(d,b)}),d.addEventListener(j?"touchend":"mouseup",function(a){a.preventDefault(),a.stopPropagation(),g=!1}),document.body.addEventListener("touchstart",function(a){a.target==d&&(a.preventDefault(),a.stopPropagation())},!1),document.body.addEventListener("touchend",function(a){a.target==d&&(a.preventDefault(),a.stopPropagation())},!1),document.body.addEventListener("touchmove",function(a){a.target==d&&(a.preventDefault(),a.stopPropagation())},!1),window.requestAnimFrame=function(a){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){window.setTimeout(a,1e3/60)}}(),function k(){requestAnimFrame(k),b()}(),$(window).resize(function(){var a=d.width,b=d.height,c=e.getImageData(0,0,a,b),f=d.getBoundingClientRect();d.width=f.width,d.height=f.height,a=d.width,b=d.height,e.putImageData(c,0,0)})}define(["jquery"],function(a){return{init:function(){initialize()},save:function(){initialize()}}});